---
import PostIcon from '@icons/dashboard/post.svg';
import LogOut from '@icons/dashboard/logout.svg'; 
import Heading from '../../heading/Heading.astro';

const { activeSection = 'dashboard', user = { name: 'Admin User', email: 'admin@example.com' } } = Astro.props;

const sidebarItems = [
  // { id: "dashboard", label: "Dashboard", icon: BarChart3 },
  { id: "posts", label: "Posts", icon: PostIcon },
  // { id: "users", label: "Users", icon: Users },
  // { id: "settings", label: "Settings", icon: Settings },
];
---

<aside class="w-64 h-screen flex flex-col border-r" style="background: var(--color-primary); border-color: var(--color-accent);">
  <!-- Logo Section -->
  <div class="p-6 border-b" style="border-color: var(--color-accent);">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 relative">
        <img src="/public/svg/isologo-color.svg" alt="Logo" class="object-contain w-full h-full" />
      </div>
      <div>
  <h1 class="text-[var(--color-neutral)] font-mono font-bold text-lg">Admin Panel</h1>
  <p class="text-[color-mix(in_srgb,var(--color-neutral)_70%,transparent)] text-sm">Post Management</p>
      </div>
    </div>
  </div>

  <!-- Navigation Items -->
  <nav class="flex-1 p-4 space-y-2">
    <ul class="space-y-1">
      {sidebarItems.map(item => {
        const Icon = item.icon;
        const isActive = activeSection === item.id;
        return (
          <li>
            <a
              href="#"
              class={`flex items-center gap-3 h-12 px-3 rounded-lg font-medium text-sm transition-all duration-200
                ${isActive
                  ? "bg-[var(--color-accent)] text-[var(--color-neutral)]"
                  : "text-[color-mix(in_srgb,var(--color-neutral)_80%,transparent)] hover:bg-[color-mix(in_srgb,var(--color-accent)_70%,transparent)] hover:text-[var(--color-neutral)]"}
              `}
              aria-current={isActive ? "page" : undefined}
              data-section={item.id}
            >
              <Icon class="w-5 h-5" />
              <span class="font-sans">{item.label}</span>
            </a>
          </li>
        );
      })}
    </ul>
  </nav>

  <!-- User Section -->
  <div class="p-4 border-t" style="border-color: var(--color-accent);">
    <div class="flex items-center gap-3 mb-4 p-3 rounded-lg" style="background: var(--color-accent);">
      <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background: var(--color-secondary);">
        <span class="text-[var(--color-neutral)] font-mono font-bold text-sm">
          {user?.name?.charAt(0) || "A"}
        </span>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-[var(--color-neutral)] font-medium text-sm truncate">{user?.name || "Admin User"}</p>
        <p class="text-[color-mix(in_srgb,var(--color-neutral)_70%,transparent)] text-xs truncate">{user?.email || "admin@example.com"}</p>
      </div>
    </div>
    <a
      href="#"
      id="btn-logout"
      class="w-full flex items-center gap-3 h-10 text-[var(--color-neutral)] hover:bg-[color-mix(in_srgb,#e06c75_10%,transparent)] hover:text-[#e06c75] transition-colors rounded-lg px-3 text-sm font-medium"
    >
      <LogOut class="w-4 h-4" />
      <span class="font-sans">Cerrar sesión</span>
    </a>
  </div>
</aside>

<script>
  import { signOut } from '@lib/auth/auth-client';
  // Navegación de secciones
  document.querySelectorAll('a[data-section]').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const section = link.getAttribute('data-section');
      if (section) {
        window.dispatchEvent(new CustomEvent('sidebar-section-change', { detail: { section } }));
      }
    });
  });
  // Logout
  const btnLogout = document.getElementById('btn-logout');
  btnLogout?.addEventListener('click', async (e) => {
    e.preventDefault();
    await signOut();
    window.location.href = '/';
  });
</script>